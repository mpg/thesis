% !TEX root = main

\chapter{Distances projectives} \label{chap:distv}

\section{Définitions} \label{sec:distv-def}

\later
On utilisera la notion de distance locale (c.-à-d. relative à une place $v$ de
$\cdn$) entre points et sous-variétés de $\Proj^n$, définie dans \cite{phidg},
dont nous rappelons ou établissons ci-dessous quelques propriétés de base,
après en avoir esquissé la construction pour mémoire. Quand aucune référence
explicite n'est donnée, les propriétés énoncées sont tirées de \cite{phidg} ou
\cite{remgdmp} ; il convient par ailleurs de spécialiser en $\mathbf{d} = (1,
\dots, 1)$ ces références pour retrouver la notion utilisée ici.

On associe à chaque sous-variété $V \subset \Proj^n$ de dimension $l-1$, sa
forme de Chow $f \in \C_v[u] = \C_v[u^{(1)}, \dots, u^{(l)}]$. Cette forme est
homogène de degré $d = \deg V$ en chaque groupe de variables $u^{(k)} =
(u^{(k)}_0, \dots, u^{(k)}_n)$ ; elle est unique modulo $\C_v^{*}$. Le
théorème~de l'élimination indique que les points de l'hypersurface définie par
$f$ dans $((\Proj^n)^\vee)^l)$ sont exactement les $l$-uplets $P_1, \dots,
P_l$ d'hyperplans de $\Proj^n$ tels que $V \cap P_1 \cap \cdots \cap P_l \neq
\emptyset$.

Pour chaque $k$ entre $1$ et $l$, on introduit un groupe de nouvelles
variables $s^{(k)}_{ij}$ indexées par les couples $0 \le i < j \le n$. Par
commodité d'écriture, on pose par ailleurs $s^{(k)}_{ij} = - s^{(k)}_{ji}$ si
$i > j$ et $s^{(k)}_{ii} = 0$. On introduit alors le morphisme $\md : \C_v[u]
\to \C_v[X, s]$ défini par $\md u^{(k)}_i = \sum_j X_j s^{(k)}_{ij}$. Pour $x
\in \C_v^n$, on note de plus $ev_x : \C_v[X, s] \to k[s]$ le morphisme
d'évaluation, et $\md_x = ev_x \circ \md$ le morphisme composé.

L'équivalence $\md_x f = 0 \Leftrightarrow \p x \in V(\C_v)$ justifie alors de
définir la distance de $\p x$ à $V$ par
\begin{equation}
  \Distv(\p x, V) = \frac{M_v(\md_x f)}{M_v(f) \Onv x ^{ld}} \pmm.
\end{equation}
Comme $\md f$ est homogène de degré $ld$ en $X$, cette quantité est bien
définie. Elle est nulle exactement dans le cas où $\p x \in V$ et est toujours
majorée par~$1$. Dans le cas où $V = \zeros(F)$ est une hypersurface, on a
l'expression naturelle $\Distv(\p x, V) = \av{F(x)} / \Onv F \Onv x$. Dans le cas
général, on peut penser aux coefficients de $\md f \in \C_v[X][s]$ comme à des
formes générales s'annulant en tout point de $V$. Enfin, dans le cas où $V$
est réduite à un point $\p y$, on a la formule explicite $\Distv (\p x, \p y) =
\Onv{x \wedge y} / \Onv x \Onv y$. On peut alors montrer (\lat{confere} \todo
[Jad])
que l'inégalité triangulaire est satisfaite et qu'on a donc bien une distance
au sens usuel entre les points.

\section{Comparaisons entre distances}

Par ailleurs, on peut également partir de la distance ainsi définie entre les
points pour définir une distance « ensembliste » entre un point et une variété
par $\Distv^E(\p x, V) = \inf_{\p y \in V(\C_v)} \Distv(\p x, \p y)$. Cette
définition présente l'inconvénient de ne pas tenir compte de la structure
géométrique de $V$, notamment des singularités éventuelles. Néanmoins, les
deux notions se comparent tout à fait bien, à l'aide des deux résultats
suivants, dont le premier est tiré de \cite[« Closest point property »
p.~89]{phidg}. On rappelle pour la lecture de ces énoncés les notations
$\gamma_n = \sum_{q=1}^{n-1} 1/2q$ et $\dv = 0$ si $v$ est ultramétrique, $\dv
= 1$ sinon.

\begin{fact} \label{ClosestPoint}
  Pour toute variété $V \subset \Proj^n$ et tout point $\p x \in
  \Proj^n(\C_v)$, il existe un point $\p y \in V(\C_v)$ tel que $\Distv(\p x, \p
  y) \le \Distv(\p x, V)^{1/\deg V} e^{\dv\gamma_{n+1}}$.
\end{fact}

\begin{lem} \label{PonctuelAlg}
  Pour toute variété $V \subset \Proj^n$ et tous points $\p x \in
  \Proj^n(\C_v)$ et $\p y \in V(\C_v)$, on a $\Distv(\p x, V) \le
  \newcst{CPonctuelAlg}\, \Distv(\p x, \p y)^m$ avec
  \begin{equation}
  \cst{CPonctuelAlg} = \left[ 2 (n+1){3m/2} \left(\frac{2n^2+1}{n^2}
  \exp\big(\gamma_{\frac{(n+1)n}2} + \gamma_{n+1}\big) \right)^{ld}
  \right]^\dv \pmm,
  \end{equation}
  où $l = \dim V + 1$, $d = \deg V$ et $m = m_{\p y}(V)$ est la multiplicité
  de $V$ en $\p y$.
\end{lem}

La démonstration repose sur un développement de $\md f$ autour de $\p y$
relativement à $X$, qui permet de quantifier le fait que, $\md_y f$ étant nul,
$\md_x f$ doit être petit pour $\p x$ voisin de $\p y$. De façon générale,
pour écrire un développement de \bsc{Taylor} , il faudra s'assurer de
l'existence une carte affine $X_i \neq 0$ contenant à la fois $\p x$ et $\p
y$. On voit facilement que la non-existence d'un telle carte affine
impliquerait $\Distv(\p x, \p y) = 1$. En pratique, on pourra supposer sans
problème que $\p x$ et $\p y$ sont suffisamment proches. Par ailleurs, il sera
utile de pouvoir de plus choisir un indice $i$ de sorte que $\av{x_i}$ (resp.
$\av{y_i}$) soit comparable  à $\Onv x$ (resp. $\Onv y$). Le lemme facile
suivant montre que c'est possible.

\begin{lem} \label{ChoixI}
  Pour chaque $\p x \in \Proj^n$, il existe $i \in \{0,\dots, n\}$ tel que
  $\frac {\av {x_i}} {\Onv x} \ge (\frac{1}{\sqrt{n+1}})^\dv$. De plus, pour le
  même indice $i$, pour tout point $\p y$ satisfaisant $\Distv(\p x, \p y) \le
  \eps_0$ avec $\eps_0 < (\frac{1}{\sqrt{n+1}})^\dv$, on a
  \begin{equation}
  \frac{\av{y_i}}{\Onv y} \ge \left(\frac{\sqrt{n+1}}{n+2}-\eps_0\right)^\dv
  \pmm.
  \end{equation}
  En particulier, si $\eps_0 < (\frac{1}{4\sqrt{n+1}})^\dv$ on a
  $\frac{\av{y_i}}{\Onv y} \ge (\frac{1}{2\sqrt{n+1}})^\dv$ et $y_i$ est non
  nul.
\end{lem}


\begin{proof}
  Pour le premier point, il suffit de choisir $i \in \{ 0, \dots, n\}$
  maximisant $\av{\coa_i}$. Afin d'alléger les notations, on supposera par la
  suite $i = 0$. Pour chaque $z = (z_0, \dots, z_n)$ on notera $\hat{z} =
  (z_1, \dots, z_n)$ le vecteur obtenu en omettant la première coordonnée. On
  a alors, vu l'hypothèse sur $\p x$ et la définition de la distance :
  \begin{equation} \label{pva}
  \eps_0 \Onv y \Onv x  \ge \Onv{y \wedge x} \ge \Onv{x_0 \hatys - y_0 \hatxs}
  \pmm{,}
  \end{equation}
  où la deuxième inégalité vient en remarquant que toutes les coordonnées de
  $x_0 \hatys - y_0 \hatxs$ apparaissent également comme coordonnées de $y
  \wedge x$.

  On traite d'abord le cas ultramétrique, par l'absurde. En effet, si on avait
  $\av{y_0}< \Onv{\hatys} = \Onv{y}$, il viendrait $\Onv{x_0 \hatys} > \Onv{y_0
  \hatxs}$ et la propriété ultramétrique appliquée au dernier membre de
  (\ref{pva}) donnerait $\eps_0 \Onv{y}\Onv{x}  \ge \av{x_0}\Onv{\hatys}$, puis
  $\eps_0 \ge 1$ contrairement aux hypothèses.

  Pour le cas archimédien, l'inégalité triangulaire dans (\ref{pva}) donne
  $\eps_0 \Onv{y}\Onv{x}  \ge \av{x_0}\Onv{\hatys} - \av{y_0}\Onv{\hatxs} $.
  En regroupant les termes et en divisant par $\Onv{y}\Onv{x}$, puis en
  remarquant que $\Onv{\hatxs}/\Onv{x} \le 1$ il vient successivement :
  \begin{align}
  \frac{\Onv{\hatxs}}{\Onv{x}} \cdot \frac{\av{y_0}}{\Onv{y}}
  & \ge \frac{\Onv{\hatys}}{\Onv{y}}\cdot \frac{\av{x_0}}{\Onv{x}} - \eps_0
  \pmm{,} \notag \\
  \frac{\av{y_0}}{\Onv{y}} & \ge
  \frac{\Onv{\hatys}}{\Onv{y}}\cdot\frac{1}{\sqrt{n+1}} - \eps_0 \pmm.
  \label{contrainte}
  \end{align}
  Notons $t = \av{y_0}/\Onv{y} \in [0; 1]$ ; comme $\Onv{y}^2 = \av{y_0}^2 +
  \Onv{\hatys}^2$, on réécrit (\ref{contrainte}) sous la forme $t \ge
  \sqrt{\frac{1-t^2}{n+1}}-\eps_0$, ou encore :
  \begin{equation}
  \left(\frac{n+2}{n+1}\right)t^2 + 2t\eps_0 + \eps_0^2 - \frac{1}{n+1} \ge
  0 \pmm,
  \end{equation}
  qui, compte tenu de l'hypothèse sur $\eps_0$ et de la positivité de $t$,
  implique :
  \begin{align*}
  t & \ge \frac{n+1}{n+2}\sqrt{\frac{-\eps_0^2}{n+1}+\frac{n+2}{(n+1)^2}} -
  \left(\frac{n+1}{n+2}\right)\eps_0\\
  & \ge \frac{\sqrt{n+1}}{n+2} - \eps_0 \pmm,
  \end{align*}
  comme annoncé. Le cas particulier s'en déduit immédiatement en substituant
  et en observant que $n \ge 2$.
\end{proof}

\begin{proof}[Démonstration du lemme~\ref{PonctuelAlg}.]
  On regarde $\md f$ comme un polynôme en $s$ à coefficients dans $k[X]$ et on
  appelle $g$ la famille de ses coefficients; ils sont homogènes de degré $ld$
  et s'annulent en $y$. On peut supposer que $\Distv(\p x, \p y) <
  (2n^2\sqrt{n+1})^{-\dv}$ car sinon la conclusion du lemme est vide, la
  distance étant identiquement bornée par $1$. On suppose alors grâce au
  lemme~précédent que $y_0 = x_0 = 1$, $\Onv y \le (\sqrt{n+1})^\dv$ et $\Onv x
  \le (2 \sqrt{n+1})^\dv$.

  Par ailleurs, $\Onv y \le \Onv x + \Onv {y-x} \le \Onv x + \Onv{x \wedge y}$, car
  chaque coefficient de $x - y$ est un coefficient de $x \wedge y$. En
  substituant $\Onv{x \wedge y} = \Distv(\p x, \p y) \Onv x \Onv y$ et en divisant
  l'inégalité obtenue par $\Onv x$, compte tenu de l'hypothèse sur la distance,
  il vient $\Onv y / \Onv x \le 1 + (2n^2)^{-1}$. On dispose alors de toutes les
  estimations utiles pour exploiter le développement de \bsc{Taylor} de la
  famille $g$ au voisinage de $y$.

  D'après \cite[prop.~3]{phitzee}, la multiplicité de $V$ en $y$ est également
  le plus grand entier $k$ tel que les dérivées d'ordre total $k-1$ de toutes
  les formes de la famille $g$ soient nulles en $y$. Le développement de $g$
  autour du point $y$ de multiplicité $m$ s'écrit donc :
  \begin{equation}
  g(x) = \sum_{k=m}^{ld} \ \overbrace{%
    \sum_{\substack{\alpha \in \N^n \\ \lgr\alpha = k}}
    \underbrace{%
    \frac 1{\alpha!} \frac{\partial^k g}{\partial X^\alpha} (y)
    \prod_{1 \le i \le n} (x_i - y_i)^{\alpha_i}}
    _{\textstyle R_{k, \alpha}}}i
  ^{\textstyle R_k}
  \pmm.
  \end{equation}

  On majore maintenant $\Onv {g(x)} / \Onv x ^{ld}$ en procédant terme à terme.
  \begin{align*}
  \frac {\Onv{R_{k, \alpha}}} {\Onv x ^{ld}}
  & \le \Onnv[v, 2]{\frac1{\alpha!}\frac{\partial^kg}{\partial X^\alpha}} \Onv
  y^{ld-k} \Onv{x \wedge y}^k / \Onv x^{ld} \\
  & \le 2^{ld\dv} \Onnv[v, 2]g \Onv y^{ld-k} \Onv x^k \Onv y^k \Distv(\p x, \p y)^k
  / \Onv x^{ld} \\
  & \le \left(\frac{2n^2+1}{n^2}\right)^{ld\dv} \Onnv[v, 2]g \Distv(\p x, \p
  y)^k (\sqrt{n+1})^{k\dv} \pmm.
  \end{align*}
  On majore alors le nombre de termes pour obtenir :
  \begin{equation}
  \frac{\Onv{R_k}}{\Onv x^{ld}} \le \left(\frac{2n^2+1}{n^2}\right)^{ld\dv}
  \Onnv[v, 2]g \Distv(\p x, \p y)^k (n+1)^{3k\dv/2} \pmm,
  \end{equation}
  puis, si $v$ est finie, $\Onv {g(x)} / \Onv x ^{ld} \le \Onnv[v, 2]g \Distv(\p x,
  \p y)^m$ par l'inégalité ultramétrique ; et si $v$ est infinie :
  \begin{align*}
  \frac{\Onv{g(x)}}{\Onv x^{ld}}
  & \le \left(\frac{2n^2+1}{n^2}\right)^{ld} \Onnv[v, 2]g \sum_{k=m}^{ld}
  \Distv(\p x, \p y)^k (n+1)^{3k/2} \\
  & \le \left(\frac{2n^2+1}{n^2}\right)^{ld} \Onnv[v, 2]g \Distv(\p x, \p y)^m
  (n+1)^{3m/2} \\
  & \phantom{\le} \qquad \cdot \sum_{k=0}^{ld-m} \big(\Distv(\p x, \p y)
  (n+1)^{3/2}\big)^k \pmm,
  \end{align*}
  où la dernière somme est majorée par $2$, d'où finalement :
  \begin{equation} \label{Comp}
  \frac{\Onv{g(x)}}{\Onv x^{ld}} \le \Onnv[v, 2]g \Distv(\p x, \p y)^m \left[ 2
  (n+1)^{3m/2} \left(\frac{2n^2+1}{n^2}\right)^{ld}\right]^\dv \pmm.
  \end{equation}
  La fin de la démonstration consiste alors en des comparaisons de normes :
  \begin{equation}
  \mv{\md_x f} i
  \stackrel{(a)}{\ll} \Onv[v, 2]{\md_x f}
  = \Onv{g(x)}
  \stackrel{(b)}{\ll} \Onnv[v, 2] g i
  = \Onv[v, 2]{\md f} i
  \stackrel{(c)}{\ll} \mv{\md f} i
  \stackrel{(d)}{\ll} \mv f
  \pmm,
  \end{equation}
  où l'on peut choisir $\exp(\dv \cdot ld \gamma_{(n+1)n/2})$ pour $(a)$ vu la
  définition et une majoration facile de l'intégrale, tandis que pour $(c)$
  l'on peut prendre $[(n+1)^2n/2]^{\dv\cdot ld}$ d'après \cite[dém. du
  lemme~3.3]{remgdmp}. La constante $(b)$ est donnée par l'inégalité
  (\ref{Comp}) ci-dessus ; la dernière découle du fait que $\mv{\md_x f} \le
  \mv{f}$ dès que $\Onv x = 1$ (c.-à-d. du fait que la distance est majorée par
  $1$). En reportant ceci dans la définition de $\mv{\truc}$ et en intégrant,
  il vient $\mv{\md f} \le \exp(\dv\cdot ld \gamma_{n+1}) \mv f$. Le lemme
  suit en mettant ces constantes bout à bout.
\end{proof}

On sera naturellement amené à considérer des situations multiprojectives. Dans
ce cas, plusieurs notions de distances peuvent être considérées, dont seules
les deux plus élémentaires nous intéressent ici : il s'agit du maximum des
distances sur chaque facteur d'une part, et de la distance déduite d'un
plongement de \bsc{Segre} d'autre part. Ces distances se comparent bien en
général ; on écrit ici la comparaison dans le cas de $(\Proj^n)^2$ (cas $q =
2$, $d=(1,1)$ de \cite[lemme~4.3]{remgdmp}) :
\begin{equation}
  \max_{i \in \{1, 2\}} \Distv(\p x^{(i)}, \p y^{(i)})
  \le \Distv(s(\p x), s(\p y))
  \le \sqrt 2^{\,\dv} \max_{i \in \{1, 2\}} \Distv(\p x^{(i)}, \p y^{(i)}) \pmm,
\end{equation}
où $\p x = (\p x^{(1)}, \p x^{(2)}) \in (\Proj^n)^2$ et $s : (\Proj^n)^2 \to
\Proj^{n^2+2n}$ est le plongement de \bsc{Segre}.

\endinput

% vim: spell spelllang=fr
